args.seqlen=2048, args.maxseqlen=1024, args.include_sparse=True
splitting into 1 GPUs
Load quantizers.
k:  model.layers.0.self_attn.k_proj
k:  model.layers.0.self_attn.v_proj
k:  model.layers.1.self_attn.k_proj
k:  model.layers.1.self_attn.v_proj
k:  model.layers.2.self_attn.k_proj
k:  model.layers.2.self_attn.v_proj
k:  model.layers.3.self_attn.k_proj
k:  model.layers.3.self_attn.v_proj
k:  model.layers.4.self_attn.k_proj
k:  model.layers.4.self_attn.v_proj
k:  model.layers.5.self_attn.k_proj
k:  model.layers.5.self_attn.v_proj
k:  model.layers.6.self_attn.k_proj
k:  model.layers.6.self_attn.v_proj
k:  model.layers.7.self_attn.k_proj
k:  model.layers.7.self_attn.v_proj
k:  model.layers.8.self_attn.k_proj
k:  model.layers.8.self_attn.v_proj
k:  model.layers.9.self_attn.k_proj
k:  model.layers.9.self_attn.v_proj
k:  model.layers.10.self_attn.k_proj
k:  model.layers.10.self_attn.v_proj
k:  model.layers.11.self_attn.k_proj
k:  model.layers.11.self_attn.v_proj
k:  model.layers.12.self_attn.k_proj
k:  model.layers.12.self_attn.v_proj
k:  model.layers.13.self_attn.k_proj
k:  model.layers.13.self_attn.v_proj
k:  model.layers.14.self_attn.k_proj
k:  model.layers.14.self_attn.v_proj
k:  model.layers.15.self_attn.k_proj
k:  model.layers.15.self_attn.v_proj
k:  model.layers.16.self_attn.k_proj
k:  model.layers.16.self_attn.v_proj
k:  model.layers.17.self_attn.k_proj
k:  model.layers.17.self_attn.v_proj
k:  model.layers.18.self_attn.k_proj
k:  model.layers.18.self_attn.v_proj
k:  model.layers.19.self_attn.k_proj
k:  model.layers.19.self_attn.v_proj
k:  model.layers.20.self_attn.k_proj
k:  model.layers.20.self_attn.v_proj
k:  model.layers.21.self_attn.k_proj
k:  model.layers.21.self_attn.v_proj
Model type : llama
Benchmarking ...
0 0.2898890972137451
1 0.04185962677001953
2 0.04031634330749512
3 0.04025912284851074
4 0.04046964645385742
5 0.04042315483093262
6 0.040616750717163086
7 0.040060997009277344
8 0.040338754653930664
9 0.04046225547790527
10 0.0399928092956543
11 0.04054856300354004
12 0.04093217849731445
13 0.04089021682739258
14 0.040431976318359375
15 0.040335893630981445
16 0.04067039489746094
17 0.040166378021240234
18 0.04047393798828125
19 0.0403592586517334
20 0.04041123390197754
21 0.04051518440246582
22 0.04010581970214844
23 0.04030489921569824
24 0.04097867012023926
25 0.04158830642700195
26 0.04093503952026367
27 0.04040098190307617
28 0.040560007095336914
29 0.04003119468688965
30 0.04044055938720703
31 0.040224313735961914
32 0.04062008857727051
33 0.04023432731628418
34 0.0401308536529541
35 0.04003000259399414
36 0.04044365882873535
37 0.04011654853820801
38 0.040256500244140625
39 0.04001641273498535
40 0.04032397270202637
41 0.040376901626586914
42 0.040108680725097656
43 0.0403292179107666
44 0.040250301361083984
45 0.040223121643066406
46 0.04038524627685547
47 0.040180206298828125
48 0.04039716720581055
49 0.040163516998291016
50 0.04057645797729492
51 0.04095149040222168
52 0.04095602035522461
53 0.0407109260559082
54 0.0403447151184082
55 0.04075288772583008
56 0.04023551940917969
57 0.04034066200256348
58 0.0404512882232666
59 0.04020237922668457
60 0.0405123233795166
61 0.04030251502990723
62 0.04029130935668945
63 0.040314674377441406
64 0.04041767120361328
65 0.04054880142211914
66 0.04056262969970703
67 0.04022669792175293
68 0.040427446365356445
69 0.04013252258300781
70 0.04042363166809082
71 0.04008674621582031
72 0.03999447822570801
73 0.040201663970947266
74 0.03997373580932617
75 0.040306806564331055
76 0.040181636810302734
77 0.0405421257019043
78 0.04031085968017578
79 0.04021596908569336
80 0.04051375389099121
81 0.04020977020263672
82 0.04041790962219238
83 0.04034876823425293
84 0.0403292179107666
85 0.040650367736816406
86 0.04029273986816406
87 0.04026532173156738
88 0.04029488563537598
89 0.04018259048461914
90 0.040476083755493164
91 0.04042863845825195
92 0.04035496711730957
93 0.04038548469543457
94 0.040157318115234375
95 0.0404052734375
96 0.04009699821472168
97 0.04043316841125488
98 0.04029536247253418
99 0.04013562202453613
100 0.04047989845275879
101 0.0400547981262207
102 0.04062461853027344
103 0.04026150703430176
104 0.04009866714477539
105 0.04060006141662598
106 0.040383338928222656
107 0.04046201705932617
108 0.04029536247253418
109 0.04027533531188965
110 0.04065513610839844
111 0.04013252258300781
112 0.04025435447692871
113 0.04013252258300781
114 0.04032778739929199
115 0.040456295013427734
116 0.040380001068115234
117 0.04056906700134277
118 0.04028582572937012
119 0.04022669792175293
120 0.04048633575439453
121 0.04069256782531738
122 0.04033374786376953
123 0.040064334869384766
124 0.040894508361816406
125 0.0403590202331543
126 0.04044294357299805
127 0.04058074951171875
128 0.04025554656982422
129 0.040842294692993164
130 0.040694236755371094
131 0.040265798568725586
132 0.04045414924621582
133 0.04040074348449707
134 0.04091453552246094
135 0.04015326499938965
136 0.039957284927368164
137 0.040348052978515625
138 0.040157318115234375
139 0.04075932502746582
140 0.04063081741333008
141 0.04024553298950195
142 0.0406346321105957
143 0.040384769439697266
144 0.04053640365600586
145 0.04006457328796387
146 0.040760040283203125
147 0.041216373443603516
148 0.04155564308166504
149 0.040999650955200195
150 0.0404055118560791
151 0.04075479507446289
152 0.040238142013549805
153 0.04018545150756836
154 0.040264129638671875
155 0.040563106536865234
156 0.04032611846923828
157 0.040084123611450195
158 0.039963483810424805
159 0.04038429260253906
160 0.03997611999511719
161 0.04121685028076172
162 0.040978193283081055
163 0.04019355773925781
164 0.04037761688232422
165 0.04011058807373047
166 0.04045605659484863
167 0.040650129318237305
168 0.04033637046813965
169 0.04063773155212402
170 0.04002547264099121
171 0.04012298583984375
172 0.039734601974487305
173 0.04040360450744629
174 0.04067420959472656
175 0.0401761531829834
176 0.040496826171875
177 0.04006648063659668
178 0.04025149345397949
179 0.040247440338134766
180 0.03986549377441406
181 0.04037332534790039
182 0.039954423904418945
183 0.04016423225402832
184 0.04000735282897949
185 0.039900779724121094
186 0.03996634483337402
187 0.039659976959228516
188 0.04021787643432617
189 0.039937496185302734
190 0.04005265235900879
191 0.04041624069213867
192 0.03980135917663574
193 0.040238142013549805
194 0.03995800018310547
195 0.03977560997009277
196 0.040138959884643555
197 0.0396270751953125
198 0.04011988639831543
199 0.04010915756225586
200 0.039661407470703125
201 0.040169477462768555
202 0.03969383239746094
203 0.040222883224487305
204 0.04019808769226074
205 0.039755821228027344
206 0.0401310920715332
207 0.03991055488586426
208 0.0400698184967041
209 0.04004955291748047
210 0.039522647857666016
211 0.04037356376647949
212 0.03963518142700195
213 0.0403749942779541
214 0.04013633728027344
215 0.039962053298950195
216 0.04044079780578613
217 0.04003763198852539
218 0.040329933166503906
219 0.040374755859375
220 0.04009389877319336
221 0.04016590118408203
222 0.03995561599731445
223 0.04024982452392578
224 0.03995871543884277
225 0.040444374084472656
226 0.0404202938079834
227 0.039926767349243164
228 0.04030466079711914
229 0.040387868881225586
230 0.040155887603759766
231 0.04027891159057617
232 0.040303945541381836
233 0.040273189544677734
234 0.04031658172607422
235 0.04024076461791992
236 0.04012799263000488
237 0.04034852981567383
238 0.04027199745178223
239 0.04023027420043945
240 0.0401611328125
241 0.040404558181762695
242 0.0400395393371582
243 0.040518760681152344
244 0.040040016174316406
245 0.040307044982910156
246 0.040262460708618164
247 0.04009246826171875
248 0.040444374084472656
249 0.0401613712310791
250 0.04044985771179199
251 0.04067850112915039
252 0.04050874710083008
253 0.040816545486450195
254 0.0404200553894043
255 0.04048895835876465
256 0.04028153419494629
257 0.040329694747924805
258 0.04053902626037598
259 0.04030966758728027
260 0.040442705154418945
261 0.0401921272277832
262 0.040487051010131836
263 0.040700435638427734
264 0.04036211967468262
265 0.0405268669128418
266 0.04029703140258789
267 0.0402219295501709
268 0.04042458534240723
269 0.039988040924072266
270 0.03997230529785156
271 0.040064096450805664
272 0.04024386405944824
273 0.04043984413146973
274 0.04040884971618652
275 0.04039788246154785
276 0.04001879692077637
277 0.040291786193847656
278 0.040569305419921875
279 0.04035329818725586
280 0.04024672508239746
281 0.04013872146606445
282 0.040106773376464844
283 0.04035544395446777
284 0.03989243507385254
285 0.04019331932067871
286 0.03993868827819824
287 0.04042506217956543
288 0.04027080535888672
289 0.03974175453186035
290 0.04038596153259277
291 0.0403287410736084
292 0.03996610641479492
293 0.040137290954589844
294 0.040120840072631836
295 0.04069042205810547
296 0.04010510444641113
297 0.040248870849609375
298 0.040912628173828125
299 0.04105043411254883
300 0.04176807403564453
301 0.04270648956298828
302 0.041810035705566406
303 0.04103684425354004
304 0.04051327705383301
305 0.04105806350708008
306 0.04082942008972168
307 0.04060506820678711
308 0.04018354415893555
309 0.04001474380493164
310 0.04045391082763672
311 0.040018558502197266
312 0.04024338722229004
313 0.04006600379943848
314 0.04032325744628906
315 0.04031705856323242
316 0.040641069412231445
317 0.040548086166381836
318 0.040177345275878906
319 0.04032278060913086
320 0.04027366638183594
321 0.04030776023864746
322 0.040608882904052734
323 0.04031562805175781
324 0.04043459892272949
325 0.04044175148010254
326 0.04032444953918457
327 0.040621280670166016
328 0.04020524024963379
329 0.04052114486694336
330 0.040453433990478516
331 0.04027366638183594
332 0.04031634330749512
333 0.04010319709777832
334 0.040311336517333984
335 0.03999686241149902
336 0.04068732261657715
337 0.04091954231262207
338 0.03997611999511719
339 0.04029679298400879
340 0.040328264236450195
341 0.039872169494628906
342 0.04039144515991211
343 0.03987431526184082
344 0.040190935134887695
345 0.04008793830871582
346 0.03989815711975098
347 0.04017281532287598
348 0.040167808532714844
349 0.04056882858276367
350 0.04062652587890625
351 0.04091048240661621
352 0.040552616119384766
353 0.04043984413146973
354 0.040400028228759766
355 0.04007673263549805
356 0.04030919075012207
357 0.0403447151184082
358 0.040433406829833984
359 0.040413856506347656
360 0.0402984619140625
361 0.040632009506225586
362 0.04057955741882324
363 0.04030799865722656
364 0.04056739807128906
365 0.040210723876953125
366 0.040344953536987305
367 0.040253639221191406
368 0.04005074501037598
369 0.04018449783325195
370 0.040047407150268555
371 0.04048323631286621
372 0.04022932052612305
373 0.04039263725280762
374 0.04053783416748047
375 0.040296077728271484
376 0.04058504104614258
377 0.040288686752319336
378 0.040378570556640625
379 0.0404665470123291
380 0.04006552696228027
381 0.04040956497192383
382 0.04012727737426758
383 0.040300607681274414
384 0.04029226303100586
385 0.04017758369445801
386 0.040456295013427734
387 0.04011273384094238
388 0.0403439998626709
389 0.04040837287902832
390 0.04034614562988281
391 0.04046225547790527
392 0.04014897346496582
393 0.04033946990966797
394 0.040395259857177734
395 0.04004192352294922
396 0.040346622467041016
397 0.040091753005981445
398 0.04040813446044922
399 0.04030632972717285
400 0.04041171073913574
401 0.04047274589538574
402 0.04016852378845215
403 0.04056668281555176
404 0.040283918380737305
405 0.04036593437194824
406 0.04047584533691406
407 0.04021000862121582
408 0.0401458740234375
409 0.04031658172607422
410 0.040308475494384766
411 0.04032778739929199
412 0.04008340835571289
413 0.04033517837524414
414 0.04037022590637207
415 0.0401310920715332
416 0.040524959564208984
417 0.040010929107666016
418 0.0403594970703125
419 0.04023623466491699
420 0.04015636444091797
421 0.04057645797729492
422 0.04016542434692383
423 0.04031968116760254
424 0.04026031494140625
425 0.040421485900878906
426 0.04060959815979004
427 0.04023432731628418
428 0.04042506217956543
429 0.04030036926269531
430 0.04026675224304199
431 0.04023408889770508
432 0.04000663757324219
433 0.04012179374694824
434 0.04021739959716797
435 0.04032468795776367
436 0.04029250144958496
437 0.040006399154663086
438 0.0404050350189209
439 0.0400848388671875
440 0.04035520553588867
441 0.040340423583984375
442 0.040117740631103516
443 0.0405735969543457
444 0.03997969627380371
445 0.04022216796875
446 0.040152549743652344
447 0.04066896438598633
448 0.04074573516845703
449 0.0405886173248291
450 0.04079604148864746
451 0.04063010215759277
452 0.04048967361450195
453 0.040576934814453125
454 0.0401003360748291
455 0.0404207706451416
456 0.04030013084411621
457 0.04015493392944336
458 0.04015684127807617
459 0.04025149345397949
460 0.04065275192260742
461 0.0403592586517334
462 0.0402073860168457
463 0.04043149948120117
464 0.040239810943603516
465 0.04071354866027832
466 0.040212154388427734
467 0.04015851020812988
468 0.04018282890319824
469 0.04018115997314453
470 0.04034304618835449
471 0.04022574424743652
472 0.040320634841918945
473 0.04052424430847168
474 0.040258169174194336
475 0.04048347473144531
476 0.04029393196105957
477 0.04043412208557129
478 0.040493011474609375
479 0.040239572525024414
480 0.04040789604187012
481 0.04027199745178223
482 0.04028892517089844
483 0.04026532173156738
484 0.04056429862976074
485 0.040447235107421875
486 0.040004730224609375
487 0.0402987003326416
488 0.04031515121459961
489 0.04012751579284668
490 0.040822744369506836
491 0.04017806053161621
492 0.040314435958862305
493 0.04021120071411133
494 0.04020881652832031
495 0.04041457176208496
496 0.040162086486816406
497 0.04051089286804199
498 0.04041290283203125
499 0.040383338928222656
500 0.040315866470336914
501 0.04029512405395508
502 0.04047250747680664
503 0.040351152420043945
504 0.04032111167907715
505 0.040589332580566406
506 0.0402064323425293
507 0.04017996788024902
508 0.04012918472290039
509 0.04022574424743652
510 0.040412187576293945
511 0.03993344306945801
Median: 0.040314555168151855
PPL: nan
max memory(MiB): 2123.24609375
